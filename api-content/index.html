{"posts":[{"title":"1","content":" ","link":"https://shgshajw.github.io/1/"},{"title":"利用Github Action刷Microsoft 365 E5开发者订阅API实现续订","content":"昨天又介绍了一次E5试用订阅！目前已知的经常使用Microsoft 365 API能实现订阅的续订！ 本文介绍一下不用“充元宝”，全靠手打的，散人全自动刷API方案！！ 原理：利用免费的Github Action 定期刷 Microsoft 365 API！不用服务器搭建！ 本文的方法不能100%保证试用订阅能续订！！介意者请绕道哈！！ 准备工作 1）E5管理账号 2）Github账号（不建议用常用账号） 3）记事本（用于记录ID密码！） 开源项目 https://github.com/wangziyingwen/AutoApiSecret 项目说明中有完整的教程！博主按照教程撸了一遍！然后补全图片和完善文案！ 操作步骤 获取Token 这里介绍完全自己！ 1）前往 https://portal.azure.com/ 登陆E5管理账号注册应用。 首页找到【Azure Active Directory】（如果没有可以搜索）然后点击【应用注册】-&gt; 【+新注册】！ 2）【名称】 随便填写，受支持的账户类型 选择【任何组织目录(任何 Azure AD 目录 – 多租户)中的帐户】 【重定向URI】填写：http://localhost:53682/ 然后点击【注册】 3）注册成功后，将【应用程序(客户端)ID】记录下来，后面会用到！ 4）点击左侧菜单【API权限】-&gt; 【添加权限】 -&gt; 【Microsoft Graph】-&gt; 选中【委托的权限】 以下权限分别搜索勾选！勾选完点击按钮【添加权限】 Files.Read.All Files.ReadWrite.All Sites.Read.All Sites.ReadWrite.All User.Read.All User.ReadWrite.All Directory.Read.All Directory.ReadWrite.All Mail.Read Mail.ReadWrite MailboxSettings.Read MailboxSettings.ReadWrite 5）在API权限页面，如果界面上有【代表xxx授予管理员同意】按钮，一定要点一下，然后同意授权！ 如果没有这个按钮，就不用管了！ 6）点击左侧菜单【证书和密码】-&gt; 【+新客户端密码】 【说明】随便填，【截止期限】随便选！点击【添加】按钮。 然后页面下方可见新建的密码，然后将【值】复制记录下来！后面会用到！ 7）我们利用rclone来获取Token! 下载rclone（【rclone下载地址1】【rclone下载地址2】）到电脑某个盘符下，在rclone.exe同目录中，按Shift+鼠标右键，选择在【此处打开cmd窗口】或【在此处打开power shell窗口】 然后在弹出执行命令！ 1 ./rclone authorize &quot;onedrive&quot; &quot;应用程序(客户端)ID&quot; &quot;应用程序密码&quot; 本文演示的ID和密码！ ./rclone authorize &quot;onedrive&quot; &quot;c33b7c34-2d87-4b89-89f0-469d6e78a55e&quot; &quot;P0zNhn1e._BD.6xxxxxxx~Ced9JR3&quot; 执行命令后弹出网页登陆E5管理账号，然后接受授权即可！ 8）授权成功后，窗口弹出得到的Token信息！复制内容 仅复制 【Paste the following into your remote machine —&gt;】开头【&lt;—End paste】结尾的中间部分内容！ 利用搜索引擎找一个【JSON在线格式】的网站，将复制的内容格式化一下。复制refresh_token值内容！不要双引号！ 克隆项目 这里利用的是Github的私有项目来做，如果你认为无所谓可以直接fork原作者的项目！然后直接跳过本节！ 1）登陆Github账号，新建项目（ New repository）！ 名称随便，可设置为私有(Private)，想公开项目也行。 为了安全还是私有吧！ 2）项目新建成功后，我们选择Import 导入一个项目！ 项目地址：https://github.com/wangziyingwen/AutoApiSecret 或者导入：https://github.com/malaohu/AutoApiSecret 导入的过程略慢！需要多等等！ 配置参数 1）在线编辑你项目里的1.txt 文件，将整个refresh_token覆盖粘贴进去（原内容不要保留）。 2）依次点击上栏 【Setting】-&gt; 【Secrets】 -&gt; 【Add a new secret】 分别新建：CONFIG_ID、CONFIG_KEY 替换你的ID 和 密码！一定要注意前面r 和 单引号！ CONFIG_ID id=r'应用程序(客户端)ID' CONFIG_KEY secret=r'应用程序密码' 3）打开地址：https://github.com/settings/tokens 点击【Generate new token】 设置名字：GITHUB_TOKEN , 勾选 repo , admin:repo_hook , workflow 等选项，点击按钮【Generate token】！ 测试运行 点击一下Github项目的星星（Star）立马调用一次脚本，再点击上面的【Action】就能看到每次的运行日志，看看运行状况！ 如图展示日志，说明成功啦！！3小时后再确认下是否自动运行了（ation里是否多出来几个），是的话就不用管了！ 最后说明 1）复制各种ID，密码，Token的时候一定要多注意！多个空格，少个标点符号都导致无法运行！ 2）项目设定每3小时自动运行一次，每次调用3轮。定时自动启动修改地方文件 .github/workflow/AutoApiSecret.yml（自行百度cron定时任务格式，最短每5分钟一次）私有仓库有限制谨慎修改！ 3）无论怎么刷API也不能100%保证能续订服务！！！ 4）自动运行会更新1.txt文件，会生成好多无用的提交记录，可能影响使用Github! ","link":"https://shgshajw.github.io/li-yong-github-action-shua-microsoft-365-e5-kai-fa-zhe-ding-yue-api-shi-xian-xu-ding/"},{"title":"优豆云免费服务器","content":"优豆云非常不错,这个不仅免费，而且配置也比较良心,挺不错的,和同类型的免费云服务器比起来，这配置算是高的了，同平台的大部分首次开通都是要收费用的，而阿贝云直接免费申请了，这一点就甩同行一大截了 而且真的很用心坚持了服务器运行十分稳定，而且性价比是我见过的同类型服务器中最高的。对于我们初学者建站有了很大的保障。我觉得可以一直免费使用，很适合平时做一些开发测试，总结一下还是很推荐大家使用主机。1.客服的处理速度和处理的态度很好2.可以一直免费使用，很适合平时做一些开发测试3.服务器的访问速度很不错4.免费服务器运行稳定，性价比较高的网站：www.udouyun.com ","link":"https://shgshajw.github.io/you-dou-yun-mian-fei-fu-wu-qi/"},{"title":"阿贝云免费服务器","content":"阿贝云非常不错,这个不仅免费，而且配置也比较良心,挺不错的,和同类型的免费云服务器比起来，这配置算是高的了，同平台的大部分首次开通都是要收费用的，而阿贝云直接免费申请了，这一点就甩同行一大截了 而且真的很用心坚持了服务器运行十分稳定，而且性价比是我见过的同类型服务器中最高的。对于我们初学者建站有了很大的保障。我觉得可以一直免费使用，很适合平时做一些开发测试，总结一下还是很推荐大家使用主机。1.客服的处理速度和处理的态度很好2.可以一直免费使用，很适合平时做一些开发测试3.服务器的访问速度很不错4.免费服务器运行稳定，性价比较高的网站：www.abeiyun.com ","link":"https://shgshajw.github.io/a-bei-yun-mian-fei-fu-wu-qi/"},{"title":"Oneindex手动注册应用","content":" 近期有搭建oneindex的用户会发现oneindex自动注册机制已经失效了，提示错误类似：Sun, 12 Jul &gt;2020 10:23:51 GMT | ? | ? 本文将解决这个问题. 点击“ 获取应用ID和机密(分两个页面显示，请注意保存)”按钮 正常登入账户 错误原因分析 微软对office应用注册页面进行了调整，旧版页面已经不可用 解决方案 使用Azure创建应用 手动注册 进入应用注册 在上方搜索栏输入“应用注册” 新注册 应用名称自定，重定向 URI为：https://oneindex.github.io/ 对照图片操作 接着创建密码 复制密码，填入 返回 概览，获取应用程序ID 填入 最后进行账号绑定，一定要用与刚才注册的一个账户 ","link":"https://shgshajw.github.io/oneindex-shou-dong-zhu-ce-ying-yong/"},{"title":"H2-3超级管理员账号密码","content":"CMCCAdmin aDm8H%MdA ","link":"https://shgshajw.github.io/qwq/"}]}